<!doctype html><html lang="en"><head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NC Sigma Portal</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="/styles/site.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head><body class="bg-light">
<nav class="navbar navbar-dark">
  <div class="container d-flex align-items-center justify-content-between">
    <a class="navbar-brand d-flex align-items-center brand" href="/">
      <img src="/img/nc-crest.png" alt="NC Crest" onerror="this.style.display='none'">
      <span>NC Sigma Portal</span>
    </a>
    <div class="navbar-nav">
      <a class="nav-link" href="/documents.html">Documents</a>
      <a class="nav-link" href="/media.html">Media</a>
      <a class="nav-link" href="/chapters.html">Chapters</a>
      <a class="nav-link" href="/admin">Admin</a>
    </div>
  </div>
</nav>

<div class="container py-4">
  <div class="row">
    <div class="col-md-4">
      <div class="card text-center"><div class="card-body">
        <div class="h6 text-muted">Active Brothers (latest)</div>
        <div id="kpi" class="display-5 fw-bold">â€”</div>
      </div></div>
    </div>
    <div class="col-md-8">
      <canvas id="chart"></canvas>
    </div>
  </div>
</div>
<script>
async function main(){
  const k=await (await fetch('/api/stats/active-brothers/latest')).json();
  document.getElementById('kpi').textContent=k.active||0;
  const c=await (await fetch('/api/chapters')).json();
  if(!c.length) return;
  const g=await (await fetch(`/api/chapters/${c[0].id}/growth`)).json();
  new Chart(document.getElementById('chart'),{
    type:'line',
    data:{labels:g.map(r=>`${r.year} Q${r.quarter}`),
          datasets:[{label:c[0].name,data:g.map(r=>r.active_members)}]}
  });
}
main();
</script>
</body></html>
